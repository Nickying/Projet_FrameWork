<!DOCTYPE html>
<html>
	<header>
	<title> iDeas </title>
	<link href="../include/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="../include/ideas.css" rel="stylesheet">
	<script src="../include/jquery-2.2.4.min.js"></script>
	<script src="../include/bootstrap/js/bootstrap.min.js"></script>
	</header>
	<body>
		<nav class="navbar navbar-default" id="menu">
			<div class="container-fluid">
				<div class="navbar-header">
				  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				  </button>
				  <a class="navbar-brand" href="accueil.html">iDeas</a>
				</div>
				
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav navbar-right">
						<li class="active"><a href="#"> Créer un Compte </a></li>
						<li><a href="connexion.html"> Se Connecter </a></li>
					</ul>
				</div>
			</div>
		</nav>
		
		<!-- debut -->
		<div class="row">
			<div class="col-lg-offset-2 col-lg-8">
			<form id="form" method="POST">
				<fieldset>
					<legend> Inscription </legend>
					<div class="form-group">
						<label for="pseudo">Pseudonyme</label>
						<input type="text" class="form-control" id="pseudo" placeholder="Pseudonyme" name="pseudo" required>
					</div>
					<div class="form-group">
						<label for="nom">Nom</label>
						<input type="text" class="form-control" name="nom" id="nom" placeholder="Nom" required>
					</div>
					<div class="form-group">
						<label for="prenom">Pr�nom</label>
						<input type="text" class="form-control" id="prenom" name="prenom" placeholder="Pr�nom" required>
					</div>
					<div class="form-group">
						<label for="email">E-mail</label>
						<input type="email" class="form-control" id="email" name="email" placeholder="E-mail" required>
					</div>
					<div class="form-group">
						<label for="mdp">Mot de passe</label>
						<input type="password" class="form-control" id="mdp" name="mdp" placeholder="Mot de passe" required>
					</div>
					<div class="form-group">
						<label for="cmdp">Confirmer mot de passe</label>
						<input type="password" class="form-control" id="cmdp" placeholder="Confirmer Mot de Passe" required>
					</div>
					<button id="inscrire" type="submit" formmethod="post" class="btn btn-default">S'inscrire</button>
			</form>
		</div>
		
		<script>
			$(document).ready(function() {
				
                                
                                $('#form').on('submit', function(e) {
                                    e.preventDefault(); // J'empêche le comportement par défaut du navigateur, c-à-d de soumettre le formulaire

                                    var $this = $(this); // L'objet jQuery du formulaire

                                   var password = document.getElementById("mdp")
			  , confirm_password = document.getElementById("cmdp");

				function validatePassword(){
				  if(password.value != confirm_password.value) {
					confirm_password.setCustomValidity("Mots de passe non identiques!");
				  } else {
					confirm_password.setCustomValidity('');
				  }
				}

				password.onchange = validatePassword;
				confirm_password.onkeyup = validatePassword;
                                   

                                    
                                        // Envoi de la requête HTTP en mode asynchrone
                                            $.ajax({
                                                url: "../Symfony/web/app_dev.php/pseudo", // Le nom du fichier indiqué dans le formulaire
                                                type: $this.attr('method'), // La méthode indiquée dans le formulaire (get ou post)
                                                data: $this.serialize(), // Je sérialise les données (j'envoie toutes les valeurs présentes dans le formulaire)
                                                success: function(data) { // Je récupère la réponse du fichier PHP
                                                    if (data[0].existe)
                                                    {  
                                                        
                                                    $.ajax({
                                                    url: "../Symfony/web/app_dev.php/test", // Le nom du fichier indiqué dans le formulaire
                                                    type: $this.attr('method'), // La méthode indiquée dans le formulaire (get ou post)
                                                    data: $this.serialize(), // Je sérialise les données (j'envoie toutes les valeurs présentes dans le formulaire)
                                                    success: function(html) { // Je récupère la réponse du fichier PHP
                                                        alert(html.existe);
                                                        
                                                    }
                                                    });
                                                }
                                                else
                                                {
                                                    alert("pseudo existe déja");
                                                    
                                                }
                                                }
                                            });
                                });
                              
                
			});
		</script>
	</body>
</html>
